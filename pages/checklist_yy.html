---
layout: page
title: YY教称号勾勾册
permalink: /pages/checklist_yy.html
---

<style>
/* === 核心修改：强制突破全局宽度限制 === */
body {
    max-width: 98% !important;
    padding: 0 10px !important;
}

/* 样式容器 */
.checklist-container { max-width: 100%; margin-top: 20px; }
.control-panel { margin-bottom: 20px; padding: 15px; background-color: #f5f5f5; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px; }

/* 按钮组样式优化 */
.btn-group { display: flex; gap: 10px; }
.btn { padding: 8px 16px; background-color: #333; color: #fff; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; transition: background-color 0.2s; white-space: nowrap; }
.btn:hover { background-color: #555; }
/* 红色危险按钮样式 */
.btn-danger { background-color: #d9534f; }
.btn-danger:hover { background-color: #c9302c; }

/* 进度条区域 */
.global-progress-box { margin-bottom: 25px; background: #fff; padding: 15px; border-radius: 8px; border: 1px solid #eaeaea; }
.total-progress-bar { width: 100%; height: 10px; background-color: #e0e0e0; border-radius: 5px; overflow: hidden; margin-top: 10px; }
.total-progress-fill { height: 100%; background-color: #4caf50; width: 0%; transition: width 0.3s ease; }

/* 表格区域 */
.table-responsive { overflow-x: auto; max-height: 85vh; overflow-y: auto; border: 1px solid #eaeaea; border-radius: 8px; background: #fff; position: relative; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
.matrix-table { width: 100%; border-collapse: separate; border-spacing: 0; min-width: 600px; }
.matrix-table th, .matrix-table td { padding: 10px; border-bottom: 1px solid #f0f0f0; border-right: 1px solid #f9f9f9; vertical-align: middle; }

/* 完成状态样式 */
.task-done-cell { background-color: #d1e7dd !important; transition: background-color 0.3s; }

/* 冻结行列 */
.matrix-table th { background-color: #fafafa; font-weight: 600; text-align: center; min-width: 160px; position: sticky; top: 0; z-index: 10; box-shadow: 0 2px 2px -1px rgba(0,0,0,0.1); }
.matrix-table th:first-child, .matrix-table td:first-child { position: sticky; left: 0; background-color: #fff; z-index: 2; border-right: 2px solid #eaeaea; min-width: 200px; max-width: 280px; text-align: left; }
.matrix-table th:first-child { z-index: 20; background-color: #fafafa; }

/* 任务行样式 */
.category-row td { background-color: #eeeeee; font-weight: bold; color: #333; padding: 8px 15px; text-align: left; }
.task-name { font-weight: bold; font-size: 14px; color: #333; line-height: 1.6; }
.task-remark { font-size: 12px; color: #888; margin-top: 4px; font-weight: normal; line-height: 1.6; }

/* 账号头部 */
.acc-header { display: flex; flex-direction: column; gap: 6px; align-items: center; }
.acc-name-input { text-align: center; font-weight: bold; font-size: 15px; border: 1px solid transparent; background: transparent; width: 100%; padding: 2px; }
.acc-name-input:focus { border-bottom: 1px solid #999; background: #fff; }
.acc-progress-bar { width: 100%; height: 4px; background: #eee; border-radius: 2px; overflow: hidden; }
.acc-progress-fill { height: 100%; background: #4caf50; width: 0%; transition: width 0.3s; }

/* 复选框样式 */
.checkbox-wrapper { display: flex; align-items: center; justify-content: center; height: 100%; }
.custom-checkbox { width: 20px; height: 20px; cursor: pointer; accent-color: #4caf50; }

@media screen and (max-width: 600px) { .control-panel { flex-direction: column; align-items: stretch; } .matrix-table { font-size: 13px; } }
</style>

<div class="checklist-container">
    <div style="margin-bottom: 15px;">
        <a href="/pages/checklist.html" style="font-size:14px; color:#666;">&lt; 返回勾勾册大厅</a>
    </div>

    <div class="control-panel">
        <div>
            <h2 style="font-size: 20px; font-weight: bold;">YY教称号勾勾册</h2>
            <div style="font-size: 12px; color: #666; margin-top: 4px;">YY教相关称号获取进度（勾选即完成）</div>
        </div>
        <div class="btn-group">
            <button class="btn btn-danger" onclick="resetAll()">重置数据</button>
            <button class="btn" onclick="addAccount()">+ 新增账号</button>
        </div>
    </div>

    <div class="global-progress-box">
        <div style="display:flex; justify-content:space-between; font-size:14px; font-weight:bold;">
            <span>所有账号总进度</span>
            <span id="global-progress-text">0%</span>
        </div>
        <div class="total-progress-bar">
            <div id="global-progress-fill" class="total-progress-fill"></div>
        </div>
    </div>

    <div class="table-responsive">
        <table class="matrix-table" id="checklist-table"></table>
    </div>
</div>

<script>
// ================= 配置区域 =================
const STORAGE_KEY = 'checklist_data_yy_titles';

// 数据来源：YY教称号.xlsx
// 使用说明：在 nameColor 和 remarkColor 字段中输入颜色代码即可
// 自动优化：如果输入了浅色(如 white, #efce9e 等)，系统会自动添加深色背景以保证可见性
const TASK_TEMPLATE = [
    {
        category: "YY教称号大全",
        tasks: [
            { id: "yy_01", name: "YY教宾客", nameColor: "white", remark: "相关任务：门派开设之一", remarkColor: "white" },
            { id: "yy_02", name: "YY推教销员", nameColor: "white", remark: "相关任务：买卖=忽悠", remarkColor: "white" },
            { id: "yy_03", name: "YY教小跑腿", nameColor: "white", remark: "相关任务：寻求答案", remarkColor: "white" },
            { id: "yy_04", name: "YY教特派员", nameColor: "white", remark: "相关任务：YY教消失之迷", remarkColor: "white" },
            { id: "yy_05", name: "YY教侦察员", nameColor: "#6cfb4b", remark: "相关任务：好奇害死猫--序幕", remarkColor: "#6cfb4b" },
            { id: "yy_06", name: "YY教打杂的", nameColor: "#efce9e", remark: "相关任务：我才不上当呢", remarkColor: "white" },
            { id: "yy_07", name: "YY教外派员", nameColor: "#efce9e", remark: "相关任务：教主办证", remarkColor: "white" },
            { id: "yy_08", name: "YY教快递员", nameColor: "#efce9e", remark: "相关任务：拜访高手", remarkColor: "white" },
            { id: "yy_09", name: "YY教温情天使", nameColor: "#6cfb4b", remark: "相关任务：为了看见而努力", remarkColor: "#6cfb4b" },
            { id: "yy_10", name: "YY教打手", nameColor: "#efce9e", remark: "相关任务：攻其不备", remarkColor: "white" },
            { id: "yy_11", name: "YY教调解员", nameColor: "#efce9e", remark: "相关任务：追魂令", remarkColor: "#6cfb4b" },
            { id: "yy_12", name: "YY教代班员", nameColor: "#efce9e", remark: "相关任务：昔日声威", remarkColor: "white" },
            { id: "yy_13", name: "YY教劳务员", nameColor: "#6cfb4b", remark: "相关任务：教主证件", remarkColor: "#6cfb4b" },
            { id: "yy_14", name: "YY教急救队员", nameColor: "#6cfb4b", remark: "相关任务：挽救少女霜月", remarkColor: "#6cfb4b" },
            { id: "yy_15", name: "YY教草药专家的学生", nameColor: "#6cfb4b", remark: "相关任务：我骗你的", remarkColor: "#6cfb4b" },
            { id: "yy_16", name: "YY教美容专家的助手", nameColor: "#6cfb4b", remark: "相关任务：取得证物", remarkColor: "#6cfb4b" },
            { id: "yy_17", name: "YY教建筑假行家", nameColor: "#6cfb4b", remark: "相关任务：隐藏身份", remarkColor: "white" },
            { id: "yy_18", name: "YY教戴罪之人", nameColor: "#efce9e", remark: "相关任务：捕快VS神偷", remarkColor: "white" },
            { id: "yy_19", name: "YY教礼品选购员", nameColor: "#efce9e", remark: "相关任务：阴谋", remarkColor: "white" },
            { id: "yy_20", name: "YY教和平使者", nameColor: "#efce9e", remark: "相关任务：错误·逃亡", remarkColor: "white" },
            { id: "yy_21", name: "YY教药品试验员", nameColor: "#efce9e", remark: "相关任务：复仇计划", remarkColor: "white" },
            { id: "yy_22", name: "YY教酒鬼集中营成员", nameColor: "#efce9e", remark: "相关任务：YY探险二", remarkColor: "white" },
            { id: "yy_23", name: "YY教主厨小学徒", nameColor: "#efce9e", remark: "相关任务：梦游的故事", remarkColor: "white" },
            { id: "yy_24", name: "YY教主食采购员", nameColor: "#efce9e", remark: "相关任务：千面妖人", remarkColor: "white" },
            { id: "yy_25", name: "YY教豆类采购员", nameColor: "#efce9e", remark: "相关任务：意外的线索", remarkColor: "white" },
            { id: "yy_26", name: "YY教采集能手的徒弟", nameColor: "#6cfb4b", remark: "相关任务：舞狮庆祝", remarkColor: "white" },
            { id: "yy_27", name: "YY教侦查小组队长", nameColor: "#6cfb4b", remark: "相关任务：闻风而动", remarkColor: "#6cfb4b" },
            { id: "yy_28", name: "YY教打劫小分队队长", nameColor: "#6cfb4b", remark: "相关任务：好奇害死猫--延续", remarkColor: "#6cfb4b" },
            { id: "yy_29", name: "YY教除寇小虾米", nameColor: "#6cfb4b", remark: "相关任务：YY特工之1", remarkColor: "#6cfb4b" },
            { id: "yy_30", name: "YY教荡寇大英雄", nameColor: "#6cfb4b", remark: "相关任务：杀人灭口", remarkColor: "#6cfb4b" },
            { id: "yy_31", name: "YY教之饭桶就是你", nameColor: "#6cfb4b", remark: "相关任务：最大就是我", remarkColor: "#6cfb4b" },
            { id: "yy_32", name: "YY教死乞白赖的幕僚", nameColor: "#40b4a0", remark: "相关任务：房产", remarkColor: "white" },
            { id: "yy_33", name: "YY教先遣队队员", nameColor: "#40b4a0", remark: "相关任务：捕快VS神偷续篇", remarkColor: "white" },
            { id: "yy_34", name: "YY教物资筹备组组员", nameColor: "#40b4a0", remark: "相关任务：Rp问题", remarkColor: "white" },
            { id: "yy_35", name: "YY教狗仔队王牌", nameColor: "#40b4a0", remark: "相关任务：圣女踪迹", remarkColor: "white" },
            { id: "yy_36", name: "YY教千里飞骑", nameColor: "#40b4a0", remark: "相关任务：YY教公益广告", remarkColor: "white" },
            { id: "yy_37", name: "YY教逍遥客", nameColor: "#40b4a0", remark: "相关任务：烙印的记忆", remarkColor: "white" },
            { id: "yy_38", name: "YY教纪念大使", nameColor: "#40b4a0", remark: "相关任务：寻碑", remarkColor: "#b22ae3" },
            { id: "yy_39", name: "YY教冷血无情玉面天蝎", nameColor: "#40b4a0", remark: "相关任务：斩杀地头蛇", remarkColor: "#b22ae3" },
            { id: "yy_40", name: "YY教武勇大先锋", nameColor: "#40b4a0", remark: "相关任务：你被骗了", remarkColor: "white" },
            { id: "yy_41", name: "YY教总坛特约大护法", nameColor: "#40b4a0", remark: "相关任务：远赴大漠", remarkColor: "white" },
            { id: "yy_42", name: "YY教拼图高手", nameColor: "#40b4a0", remark: "相关任务：痛苦的藏匿", remarkColor: "white" },
            { id: "yy_43", name: "YY教大公无私救世主", nameColor: "#40b4a0", remark: "相关任务：守护结界", remarkColor: "white" },
            { id: "yy_44", name: "YY教之有你这样的吗", nameColor: "#b22ae3", remark: "相关任务：收购猪肉", remarkColor: "#6cfb4b" },
            { id: "yy_45", name: "YY教神行太保", nameColor: "#40b4a0", remark: "相关任务：YY探险", remarkColor: "white" },
            { id: "yy_46", name: "YY教我选了你就得选", nameColor: "#b22ae3", remark: "相关任务：宝儿的问题", remarkColor: "#b22ae3" },
            { id: "yy_47", name: "YY教竭尽所能打击你", nameColor: "#b22ae3", remark: "相关任务：疯狂追杀令", remarkColor: "#6cfb4b" },
            { id: "yy_48", name: "YY教行动派先驱", nameColor: "#b22ae3", remark: "相关任务：采购猪肉", remarkColor: "#6cfb4b" },
            { id: "yy_49", name: "YY教之谁横谁就是爷", nameColor: "#b22ae3", remark: "相关任务：求学", remarkColor: "#b22ae3" },
            { id: "yy_50", name: "YY教传说中最可爱的人", nameColor: "#b22ae3", remark: "相关任务：比美", remarkColor: "#b22ae3" },
            { id: "yy_51", name: "冲冲冲 冲马桶", nameColor: "white", remark: "相关任务：想看见看不见的", remarkColor: "white" },
            { id: "yy_52", name: "踢到硬铁板", nameColor: "white", remark: "相关任务：清白", remarkColor: "white" },
            { id: "yy_53", name: "迷死人不偿命", nameColor: "white", remark: "相关任务：竞争激烈", remarkColor: "white" },
            { id: "yy_54", name: "超级大衰鬼", nameColor: "white", remark: "相关任务：隐藏身份的代价", remarkColor: "white" },
            { id: "yy_55", name: "难缠倒追狂", nameColor: "white", remark: "相关任务：客源之争", remarkColor: "white" },
            { id: "yy_56", name: "头被门挤过", nameColor: "white", remark: "相关任务：门派开设之二", remarkColor: "white" },
            { id: "yy_57", name: "无孔不入的蛔虫", nameColor: "white", remark: "相关任务：千里寻宝", remarkColor: "white" },
            { id: "yy_58", name: "极品口吃", nameColor: "white", remark: "相关任务：求助", remarkColor: "white" },
            { id: "yy_59", name: "赤手空拳打死你", nameColor: "white", remark: "相关任务：采花贼的末日", remarkColor: "white" },
            { id: "yy_60", name: "无耻群殴族", nameColor: "white", remark: "相关任务：广收教众", remarkColor: "white" },
            { id: "yy_61", name: "来自东北方的窝瓜", nameColor: "white", remark: "相关任务：门派设立之三", remarkColor: "white" },
            { id: "yy_62", name: "九命怪猫", nameColor: "white", remark: "相关任务：保护树林", remarkColor: "white" }
        ]
    }
];
// ============================================

let accounts = [];

document.addEventListener('DOMContentLoaded', () => {
    loadData();
    if (accounts.length === 0) {
        addAccount("主账号");
    } else {
        render();
    }
});

function loadData() {
    const data = localStorage.getItem(STORAGE_KEY);
    if (data) {
        try {
            accounts = JSON.parse(data);
        } catch (e) {
            accounts = [];
        }
    }
}

function saveData() {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(accounts));
    render();
}

function addAccount(name = "新账号") {
    const newAccount = {
        id: Date.now().toString(),
        name: name,
        progress: {} 
    };
    accounts.push(newAccount);
    saveData();
}

function removeAccount(id) {
    if(confirm("确定删除该账号及其所有进度吗？")) {
        accounts = accounts.filter(acc => acc.id !== id);
        saveData();
    }
}

// === 新增：重置所有数据函数 ===
function resetAll() {
    if(confirm("确定要清空所有账号和进度数据吗？此操作无法恢复！")) {
        localStorage.removeItem(STORAGE_KEY);
        location.reload();
    }
}

function updateName(id, newName) {
    const acc = accounts.find(a => a.id === id);
    if (acc) {
        acc.name = newName;
        localStorage.setItem(STORAGE_KEY, JSON.stringify(accounts));
    }
}

// 切换任务状态（0 或 1）
function toggleTask(accId, taskId) {
    const acc = accounts.find(a => a.id === accId);
    if (!acc) return;
    
    // 初始化进度
    if (typeof acc.progress[taskId] === 'undefined') acc.progress[taskId] = 0;
    
    // 切换状态
    const currentVal = acc.progress[taskId];
    const newVal = currentVal >= 1 ? 0 : 1;
    acc.progress[taskId] = newVal;
    
    // 更新UI样式（优化性能，不重绘整个表格，只更新当前单元格）
    const cellEl = document.getElementById(`cell-${accId}-${taskId}`);
    const checkEl = document.getElementById(`check-${accId}-${taskId}`);
    
    if (checkEl) checkEl.checked = (newVal === 1);
    
    if (cellEl) {
        if (newVal === 1) cellEl.classList.add('task-done-cell');
        else cellEl.classList.remove('task-done-cell');
    }
    
    localStorage.setItem(STORAGE_KEY, JSON.stringify(accounts));
    updateProgressUI();
}

function calculateProgress(acc) {
    let max = 0, current = 0;
    TASK_TEMPLATE.forEach(cat => {
        cat.tasks.forEach(task => {
            max += 1; // 每个任务最大值为1
            current += (acc.progress[task.id] && acc.progress[task.id] >= 1) ? 1 : 0;
        });
    });
    const pct = max === 0 ? 0 : Math.round((current / max) * 100);
    return { current, max, pct };
}

function updateProgressUI() {
    let globalTotal = 0, globalMax = 0;
    
    accounts.forEach(acc => {
        const stats = calculateProgress(acc);
        globalTotal += stats.current;
        globalMax += stats.max;
        
        const headPct = document.getElementById(`head-pct-${acc.id}`);
        const headBar = document.getElementById(`head-bar-${acc.id}`);
        if(headPct) headPct.innerText = `${stats.pct}%`;
        if(headBar) headBar.style.width = `${stats.pct}%`;
    });
    
    const gPct = globalMax === 0 ? 0 : Math.round((globalTotal / globalMax) * 100);
    const globalText = document.getElementById('global-progress-text');
    const globalFill = document.getElementById('global-progress-fill');
    
    if(globalText) globalText.innerText = `${gPct}%`;
    if(globalFill) globalFill.style.width = `${gPct}%`;
}

function render() {
    const table = document.getElementById('checklist-table');
    
    // 构建表头
    let theadHtml = `<thead><tr><th>称号 / 任务</th>${accounts.map(acc => {
        const stats = calculateProgress(acc);
        return `
            <th>
                <div class="acc-header">
                    <input class="acc-name-input" value="${acc.name}" onchange="updateName('${acc.id}', this.value)" placeholder="账号名">
                    <div style="width:100%; display:flex; justify-content:space-between; font-size:12px; color:#666;">
                        <span id="head-pct-${acc.id}">${stats.pct}%</span>
                        <span style="cursor:pointer; color:#d9534f;" onclick="removeAccount('${acc.id}')">删除</span>
                    </div>
                    <div class="acc-progress-bar">
                        <div id="head-bar-${acc.id}" class="acc-progress-fill" style="width:${stats.pct}%"></div>
                    </div>
                </div>
            </th>`;
    }).join('')}</tr></thead>`;
    
    // 构建表体
    let tbodyHtml = '<tbody>';
    
    // 渲染辅助函数：如果颜色是浅色，则增加深色背景
    const getStyle = (color) => {
        if (!color) return '';
        // 可以在这里添加所有在白底上看不清的颜色
        const lightColors = ['white', '#efce9e', '#6cfb4b']; 
        if (lightColors.includes(color.toLowerCase())) {
            // 返回带深灰色背景的样式 (display:inline-block 确保背景只包裹文字)
            return `style="color:${color}; background-color: #444; padding: 1px 4px; border-radius: 3px; display:inline-block;"`;
        }
        return `style="color:${color}"`;
    };

    TASK_TEMPLATE.forEach(cat => {
        // 分类行
        tbodyHtml += `<tr class="category-row"><td colspan="${accounts.length + 1}">${cat.category}</td></tr>`;
        
        // 任务行
        cat.tasks.forEach(task => {
            // 获取处理后的样式（含颜色和可能背景）
            const nameStyle = getStyle(task.nameColor);
            const remarkStyle = getStyle(task.remarkColor);
            
            // 特殊处理 remark: 将“相关任务：”分离出来不加颜色
            let remarkHtml = '';
            if (task.remark) {
                const prefix = "相关任务：";
                if (task.remark.startsWith(prefix)) {
                    const content = task.remark.substring(prefix.length);
                    // 前缀使用默认样式，内容使用自定义样式
                    remarkHtml = `<div class="task-remark">${prefix}<span ${remarkStyle}>${content}</span></div>`;
                } else {
                    // 如果不是以“相关任务：”开头，则整体应用样式
                    remarkHtml = `<div class="task-remark"><span ${remarkStyle}>${task.remark}</span></div>`;
                }
            }

            tbodyHtml += `<tr>
                <td>
                    <div class="task-name">
                        <span ${nameStyle}>${task.name}</span>
                    </div>
                    ${remarkHtml}
                </td>
                ${accounts.map(acc => {
                    const isDone = (acc.progress[task.id] && acc.progress[task.id] >= 1);
                    return `
                        <td id="cell-${acc.id}-${task.id}" class="${isDone ? 'task-done-cell' : ''}" onclick="if(event.target.tagName !== 'INPUT') toggleTask('${acc.id}', '${task.id}')">
                            <div class="checkbox-wrapper">
                                <input type="checkbox" 
                                       id="check-${acc.id}-${task.id}" 
                                       class="custom-checkbox" 
                                       ${isDone ? 'checked' : ''} 
                                       onchange="toggleTask('${acc.id}', '${task.id}')">
                            </div>
                        </td>`;
                }).join('')}
            </tr>`;
        });
    });
    
    tbodyHtml += '</tbody>';
    table.innerHTML = theadHtml + tbodyHtml;
    updateProgressUI();
}
</script>