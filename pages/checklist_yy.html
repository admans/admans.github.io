---
layout: page
title: YYæ•™ç§°å·å‹¾å‹¾å†Œ
permalink: /pages/checklist_yy.html
---

<style>
/* === è§†è§‰ç»Ÿä¸€åŒ–ï¼šYYæ•™ç‰ˆ === */
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: #f4f4f9;
    max-width: 98% !important;
    padding: 0 10px !important;
}

.checklist-container { max-width: 100%; margin-top: 20px; }
.back-link { font-size: 14px; color: #666; text-decoration: none; display: inline-block; margin-bottom: 15px; }
.back-link:hover { color: #333; }

/* é¢æ¿å¡ç‰‡ */
.panel-card {
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    padding: 15px;
    margin-bottom: 20px;
    border: 1px solid #eaeaea;
}

.control-panel {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 10px;
}

.btn-group { display: flex; gap: 10px; }
.btn {
    padding: 8px 16px;
    background-color: #333;
    color: #fff;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.2s;
}
.btn:hover { background-color: #555; }
.btn-danger { color: #d9534f; background: none; border: 1px solid #eee; }
.btn-danger:hover { background: #ffebee; border-color: #d9534f; color: #c9302c; }

/* è¿›åº¦æ¡ */
.total-progress-bar { width: 100%; height: 8px; background-color: #f0f0f0; border-radius: 4px; overflow: hidden; margin-top: 10px; }
.total-progress-fill { height: 100%; background-color: #4caf50; width: 0%; transition: width 0.3s ease; }

/* è¡¨æ ¼åŒºåŸŸ */
.table-responsive {
    overflow-x: auto;
    max-height: 85vh;
    overflow-y: auto;
    border-radius: 8px;
    background: #fff;
    position: relative;
    box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    border: 1px solid #eaeaea;
}
.matrix-table { width: 100%; border-collapse: separate; border-spacing: 0; min-width: 600px; }
.matrix-table th, .matrix-table td { padding: 10px; border-bottom: 1px solid #f0f0f0; border-right: 1px solid #f9f9f9; vertical-align: middle; }

/* å®ŒæˆçŠ¶æ€ */
.task-done-cell { background-color: #e8f5e9 !important; transition: background-color 0.3s; }

/* å†»ç»“è¡Œåˆ— */
.matrix-table th { background-color: #fafafa; font-weight: 600; text-align: center; min-width: 160px; position: sticky; top: 0; z-index: 10; box-shadow: 0 2px 2px -1px rgba(0,0,0,0.05); }
.matrix-table th:first-child, .matrix-table td:first-child { position: sticky; left: 0; background-color: #fff; z-index: 2; border-right: 2px solid #eaeaea; min-width: 200px; max-width: 280px; text-align: left; }
.matrix-table th:first-child { z-index: 20; background-color: #fafafa; }

/* ä»»åŠ¡è¡Œæ ·å¼ (æ·¡è“åˆ†ç±») */
.category-row td { 
    background-color: #e3f2fd; 
    font-weight: bold; 
    color: #1565c0; 
    padding: 10px 15px; 
    text-align: left; 
    border-top: 1px solid #bbdefb;
}

.task-name { font-weight: bold; font-size: 14px; color: #333; line-height: 1.6; }
.task-remark { font-size: 12px; color: #888; margin-top: 4px; font-weight: normal; line-height: 1.6; }

/* è´¦å·å¤´éƒ¨ */
.acc-header { display: flex; flex-direction: column; gap: 6px; align-items: center; }
.acc-name-input { text-align: center; font-weight: bold; font-size: 15px; border: none; border-bottom: 1px solid transparent; background: transparent; width: 100%; padding: 2px; transition: border 0.3s; }
.acc-name-input:focus { border-bottom: 1px solid #4caf50; outline: none; }
.acc-progress-bar { width: 100%; height: 4px; background: #eee; border-radius: 2px; overflow: hidden; }
.acc-progress-fill { height: 100%; background: #4caf50; width: 0%; transition: width 0.3s; }

/* å¤é€‰æ¡† */
.checkbox-wrapper { display: flex; align-items: center; justify-content: center; height: 100%; }
.custom-checkbox { width: 20px; height: 20px; cursor: pointer; accent-color: #4caf50; }

@media screen and (max-width: 600px) { .control-panel { flex-direction: column; align-items: stretch; } .matrix-table { font-size: 13px; } }
</style>

<div class="checklist-container">
    <div>
        <a href="/pages/checklist.html" class="back-link">&lt; è¿”å›å‹¾å‹¾å†Œå¤§å…</a>
    </div>

    <div class="panel-card control-panel">
        <div>
            <h2 style="margin:0; font-size: 20px; font-weight: bold; color: #333;">ğŸ”® YYæ•™ç§°å·å‹¾å‹¾å†Œ</h2>
            <div style="font-size: 12px; color: #666; margin-top: 4px;">YYæ•™ç›¸å…³ç§°å·è·å–è¿›åº¦ï¼ˆå‹¾é€‰å³å®Œæˆï¼‰</div>
        </div>
        <div class="btn-group">
            <button class="btn btn-danger" onclick="resetAll()">é‡ç½®æ•°æ®</button>
            <button class="btn" onclick="addAccount()">+ æ–°å¢è´¦å·</button>
        </div>
    </div>

    <div class="panel-card">
        <div style="display:flex; justify-content:space-between; font-size:14px; font-weight:bold; color: #555;">
            <span>æ‰€æœ‰è´¦å·æ€»è¿›åº¦</span>
            <span id="global-progress-text" style="color:#4caf50;">0%</span>
        </div>
        <div class="total-progress-bar">
            <div id="global-progress-fill" class="total-progress-fill"></div>
        </div>
    </div>

    <div class="table-responsive">
        <table class="matrix-table" id="checklist-table"></table>
    </div>
</div>

<script>
// ================= é…ç½®åŒºåŸŸ =================
const STORAGE_KEY = 'checklist_data_yy_titles';

const TASK_TEMPLATE = [
    // ... (ä»»åŠ¡æ•°æ®ä¿æŒä¸å˜) ...
    {
        category: "YYæ•™ç§°å·å¤§å…¨",
        tasks: [
            { id: "yy_01", name: "YYæ•™å®¾å®¢", nameColor: "white", remark: "ç›¸å…³ä»»åŠ¡ï¼šé—¨æ´¾å¼€è®¾ä¹‹ä¸€", remarkColor: "white" },
            { id: "yy_02", name: "YYæ¨æ•™é”€å‘˜", nameColor: "white", remark: "ç›¸å…³ä»»åŠ¡ï¼šä¹°å–=å¿½æ‚ ", remarkColor: "white" },
            { id: "yy_03", name: "YYæ•™å°è·‘è…¿", nameColor: "white", remark: "ç›¸å…³ä»»åŠ¡ï¼šå¯»æ±‚ç­”æ¡ˆ", remarkColor: "white" },
            { id: "yy_04", name: "YYæ•™ç‰¹æ´¾å‘˜", nameColor: "white", remark: "ç›¸å…³ä»»åŠ¡ï¼šYYæ•™æ¶ˆå¤±ä¹‹è¿·", remarkColor: "white" },
            { id: "yy_05", name: "YYæ•™ä¾¦å¯Ÿå‘˜", nameColor: "#6cfb4b", remark: "ç›¸å…³ä»»åŠ¡ï¼šå¥½å¥‡å®³æ­»çŒ«--åºå¹•", remarkColor: "#6cfb4b" },
            { id: "yy_06", name: "YYæ•™æ‰“æ‚çš„", nameColor: "#efce9e", remark: "ç›¸å…³ä»»åŠ¡ï¼šæˆ‘æ‰ä¸ä¸Šå½“å‘¢", remarkColor: "white" },
            { id: "yy_07", name: "YYæ•™å¤–æ´¾å‘˜", nameColor: "#efce9e", remark: "ç›¸å…³ä»»åŠ¡ï¼šæ•™ä¸»åŠè¯", remarkColor: "white" },
            { id: "yy_08", name: "YYæ•™å¿«é€’å‘˜", nameColor: "#efce9e", remark: "ç›¸å…³ä»»åŠ¡ï¼šæ‹œè®¿é«˜æ‰‹", remarkColor: "white" },
            { id: "yy_09", name: "YYæ•™æ¸©æƒ…å¤©ä½¿", nameColor: "#6cfb4b", remark: "ç›¸å…³ä»»åŠ¡ï¼šä¸ºäº†çœ‹è§è€ŒåŠªåŠ›", remarkColor: "#6cfb4b" },
            { id: "yy_10", name: "YYæ•™æ‰“æ‰‹", nameColor: "#efce9e", remark: "ç›¸å…³ä»»åŠ¡ï¼šæ”»å…¶ä¸å¤‡", remarkColor: "white" },
            { id: "yy_11", name: "YYæ•™è°ƒè§£å‘˜", nameColor: "#efce9e", remark: "ç›¸å…³ä»»åŠ¡ï¼šè¿½é­‚ä»¤", remarkColor: "#6cfb4b" },
            { id: "yy_12", name: "YYæ•™ä»£ç­å‘˜", nameColor: "#efce9e", remark: "ç›¸å…³ä»»åŠ¡ï¼šæ˜”æ—¥å£°å¨", remarkColor: "white" },
            { id: "yy_13", name: "YYæ•™åŠ³åŠ¡å‘˜", nameColor: "#6cfb4b", remark: "ç›¸å…³ä»»åŠ¡ï¼šæ•™ä¸»è¯ä»¶", remarkColor: "#6cfb4b" },
            { id: "yy_14", name: "YYæ•™æ€¥æ•‘é˜Ÿå‘˜", nameColor: "#6cfb4b", remark: "ç›¸å…³ä»»åŠ¡ï¼šæŒ½æ•‘å°‘å¥³éœœæœˆ", remarkColor: "#6cfb4b" },
            { id: "yy_15", name: "YYæ•™è‰è¯ä¸“å®¶çš„å­¦ç”Ÿ", nameColor: "#6cfb4b", remark: "ç›¸å…³ä»»åŠ¡ï¼šæˆ‘éª—ä½ çš„", remarkColor: "#6cfb4b" },
            { id: "yy_16", name: "YYæ•™ç¾å®¹ä¸“å®¶çš„åŠ©æ‰‹", nameColor: "#6cfb4b", remark: "ç›¸å…³ä»»åŠ¡ï¼šå–å¾—è¯ç‰©", remarkColor: "#6cfb4b" },
            { id: "yy_17", name: "YYæ•™å»ºç­‘å‡è¡Œå®¶", nameColor: "#6cfb4b", remark: "ç›¸å…³ä»»åŠ¡ï¼šéšè—èº«ä»½", remarkColor: "white" },
            { id: "yy_18", name: "YYæ•™æˆ´ç½ªä¹‹äºº", nameColor: "#efce9e", remark: "ç›¸å…³ä»»åŠ¡ï¼šæ•å¿«VSç¥å·", remarkColor: "white" },
            { id: "yy_19", name: "YYæ•™ç¤¼å“é€‰è´­å‘˜", nameColor: "#efce9e", remark: "ç›¸å…³ä»»åŠ¡ï¼šé˜´è°‹", remarkColor: "white" },
            { id: "yy_20", name: "YYæ•™å’Œå¹³ä½¿è€…", nameColor: "#efce9e", remark: "ç›¸å…³ä»»åŠ¡ï¼šé”™è¯¯Â·é€ƒäº¡", remarkColor: "white" },
            { id: "yy_21", name: "YYæ•™è¯å“è¯•éªŒå‘˜", nameColor: "#efce9e", remark: "ç›¸å…³ä»»åŠ¡ï¼šå¤ä»‡è®¡åˆ’", remarkColor: "white" },
            { id: "yy_22", name: "YYæ•™é…’é¬¼é›†ä¸­è¥æˆå‘˜", nameColor: "#efce9e", remark: "ç›¸å…³ä»»åŠ¡ï¼šYYæ¢é™©äºŒ", remarkColor: "white" },
            { id: "yy_23", name: "YYæ•™ä¸»å¨å°å­¦å¾’", nameColor: "#efce9e", remark: "ç›¸å…³ä»»åŠ¡ï¼šæ¢¦æ¸¸çš„æ•…äº‹", remarkColor: "white" },
            { id: "yy_24", name: "YYæ•™ä¸»é£Ÿé‡‡è´­å‘˜", nameColor: "#efce9e", remark: "ç›¸å…³ä»»åŠ¡ï¼šåƒé¢å¦–äºº", remarkColor: "white" },
            { id: "yy_25", name: "YYæ•™è±†ç±»é‡‡è´­å‘˜", nameColor: "#efce9e", remark: "ç›¸å…³ä»»åŠ¡ï¼šæ„å¤–çš„çº¿ç´¢", remarkColor: "white" },
            { id: "yy_26", name: "YYæ•™é‡‡é›†èƒ½æ‰‹çš„å¾’å¼Ÿ", nameColor: "#6cfb4b", remark: "ç›¸å…³ä»»åŠ¡ï¼šèˆç‹®åº†ç¥", remarkColor: "white" },
            { id: "yy_27", name: "YYæ•™ä¾¦æŸ¥å°ç»„é˜Ÿé•¿", nameColor: "#6cfb4b", remark: "ç›¸å…³ä»»åŠ¡ï¼šé—»é£è€ŒåŠ¨", remarkColor: "#6cfb4b" },
            { id: "yy_28", name: "YYæ•™æ‰“åŠ«å°åˆ†é˜Ÿé˜Ÿé•¿", nameColor: "#6cfb4b", remark: "ç›¸å…³ä»»åŠ¡ï¼šå¥½å¥‡å®³æ­»çŒ«--å»¶ç»­", remarkColor: "#6cfb4b" },
            { id: "yy_29", name: "YYæ•™é™¤å¯‡å°è™¾ç±³", nameColor: "#6cfb4b", remark: "ç›¸å…³ä»»åŠ¡ï¼šYYç‰¹å·¥ä¹‹1", remarkColor: "#6cfb4b" },
            { id: "yy_30", name: "YYæ•™è¡å¯‡å¤§è‹±é›„", nameColor: "#6cfb4b", remark: "ç›¸å…³ä»»åŠ¡ï¼šæ€äººç­å£", remarkColor: "#6cfb4b" },
            { id: "yy_31", name: "YYæ•™ä¹‹é¥­æ¡¶å°±æ˜¯ä½ ", nameColor: "#6cfb4b", remark: "ç›¸å…³ä»»åŠ¡ï¼šæœ€å¤§å°±æ˜¯æˆ‘", remarkColor: "#6cfb4b" },
            { id: "yy_32", name: "YYæ•™æ­»ä¹ç™½èµ–çš„å¹•åƒš", nameColor: "#40b4a0", remark: "ç›¸å…³ä»»åŠ¡ï¼šæˆ¿äº§", remarkColor: "white" },
            { id: "yy_33", name: "YYæ•™å…ˆé£é˜Ÿé˜Ÿå‘˜", nameColor: "#40b4a0", remark: "ç›¸å…³ä»»åŠ¡ï¼šæ•å¿«VSç¥å·ç»­ç¯‡", remarkColor: "white" },
            { id: "yy_34", name: "YYæ•™ç‰©èµ„ç­¹å¤‡ç»„ç»„å‘˜", nameColor: "#40b4a0", remark: "ç›¸å…³ä»»åŠ¡ï¼šRpé—®é¢˜", remarkColor: "white" },
            { id: "yy_35", name: "YYæ•™ç‹—ä»”é˜Ÿç‹ç‰Œ", nameColor: "#40b4a0", remark: "ç›¸å…³ä»»åŠ¡ï¼šåœ£å¥³è¸ªè¿¹", remarkColor: "white" },
            { id: "yy_36", name: "YYæ•™åƒé‡Œé£éª‘", nameColor: "#40b4a0", remark: "ç›¸å…³ä»»åŠ¡ï¼šYYæ•™å…¬ç›Šå¹¿å‘Š", remarkColor: "white" },
            { id: "yy_37", name: "YYæ•™é€é¥å®¢", nameColor: "#40b4a0", remark: "ç›¸å…³ä»»åŠ¡ï¼šçƒ™å°çš„è®°å¿†", remarkColor: "white" },
            { id: "yy_38", name: "YYæ•™çºªå¿µå¤§ä½¿", nameColor: "#40b4a0", remark: "ç›¸å…³ä»»åŠ¡ï¼šå¯»ç¢‘", remarkColor: "#b22ae3" },
            { id: "yy_39", name: "YYæ•™å†·è¡€æ— æƒ…ç‰é¢å¤©è", nameColor: "#40b4a0", remark: "ç›¸å…³ä»»åŠ¡ï¼šæ–©æ€åœ°å¤´è›‡", remarkColor: "#b22ae3" },
            { id: "yy_40", name: "YYæ•™æ­¦å‹‡å¤§å…ˆé”‹", nameColor: "#40b4a0", remark: "ç›¸å…³ä»»åŠ¡ï¼šä½ è¢«éª—äº†", remarkColor: "white" },
            { id: "yy_41", name: "YYæ•™æ€»å›ç‰¹çº¦å¤§æŠ¤æ³•", nameColor: "#40b4a0", remark: "ç›¸å…³ä»»åŠ¡ï¼šè¿œèµ´å¤§æ¼ ", remarkColor: "white" },
            { id: "yy_42", name: "YYæ•™æ‹¼å›¾é«˜æ‰‹", nameColor: "#40b4a0", remark: "ç›¸å…³ä»»åŠ¡ï¼šç—›è‹¦çš„è—åŒ¿", remarkColor: "white" },
            { id: "yy_43", name: "YYæ•™å¤§å…¬æ— ç§æ•‘ä¸–ä¸»", nameColor: "#40b4a0", remark: "ç›¸å…³ä»»åŠ¡ï¼šå®ˆæŠ¤ç»“ç•Œ", remarkColor: "white" },
            { id: "yy_44", name: "YYæ•™ä¹‹æœ‰ä½ è¿™æ ·çš„å—", nameColor: "#b22ae3", remark: "ç›¸å…³ä»»åŠ¡ï¼šæ”¶è´­çŒªè‚‰", remarkColor: "#6cfb4b" },
            { id: "yy_45", name: "YYæ•™ç¥è¡Œå¤ªä¿", nameColor: "#40b4a0", remark: "ç›¸å…³ä»»åŠ¡ï¼šYYæ¢é™©", remarkColor: "white" },
            { id: "yy_46", name: "YYæ•™æˆ‘é€‰äº†ä½ å°±å¾—é€‰", nameColor: "#b22ae3", remark: "ç›¸å…³ä»»åŠ¡ï¼šå®å„¿çš„é—®é¢˜", remarkColor: "#b22ae3" },
            { id: "yy_47", name: "YYæ•™ç«­å°½æ‰€èƒ½æ‰“å‡»ä½ ", nameColor: "#b22ae3", remark: "ç›¸å…³ä»»åŠ¡ï¼šç–¯ç‹‚è¿½æ€ä»¤", remarkColor: "#6cfb4b" },
            { id: "yy_48", name: "YYæ•™è¡ŒåŠ¨æ´¾å…ˆé©±", nameColor: "#b22ae3", remark: "ç›¸å…³ä»»åŠ¡ï¼šé‡‡è´­çŒªè‚‰", remarkColor: "#6cfb4b" },
            { id: "yy_49", name: "YYæ•™ä¹‹è°æ¨ªè°å°±æ˜¯çˆ·", nameColor: "#b22ae3", remark: "ç›¸å…³ä»»åŠ¡ï¼šæ±‚å­¦", remarkColor: "#b22ae3" },
            { id: "yy_50", name: "YYæ•™ä¼ è¯´ä¸­æœ€å¯çˆ±çš„äºº", nameColor: "#b22ae3", remark: "ç›¸å…³ä»»åŠ¡ï¼šæ¯”ç¾", remarkColor: "#b22ae3" },
            { id: "yy_51", name: "å†²å†²å†² å†²é©¬æ¡¶", nameColor: "white", remark: "ç›¸å…³ä»»åŠ¡ï¼šæƒ³çœ‹è§çœ‹ä¸è§çš„", remarkColor: "white" },
            { id: "yy_52", name: "è¸¢åˆ°ç¡¬é“æ¿", nameColor: "white", remark: "ç›¸å…³ä»»åŠ¡ï¼šæ¸…ç™½", remarkColor: "white" },
            { id: "yy_53", name: "è¿·æ­»äººä¸å¿å‘½", nameColor: "white", remark: "ç›¸å…³ä»»åŠ¡ï¼šç«äº‰æ¿€çƒˆ", remarkColor: "white" },
            { id: "yy_54", name: "è¶…çº§å¤§è¡°é¬¼", nameColor: "white", remark: "ç›¸å…³ä»»åŠ¡ï¼šéšè—èº«ä»½çš„ä»£ä»·", remarkColor: "white" },
            { id: "yy_55", name: "éš¾ç¼ å€’è¿½ç‹‚", nameColor: "white", remark: "ç›¸å…³ä»»åŠ¡ï¼šå®¢æºä¹‹äº‰", remarkColor: "white" },
            { id: "yy_56", name: "å¤´è¢«é—¨æŒ¤è¿‡", nameColor: "white", remark: "ç›¸å…³ä»»åŠ¡ï¼šé—¨æ´¾å¼€è®¾ä¹‹äºŒ", remarkColor: "white" },
            { id: "yy_57", name: "æ— å­”ä¸å…¥çš„è›”è™«", nameColor: "white", remark: "ç›¸å…³ä»»åŠ¡ï¼šåƒé‡Œå¯»å®", remarkColor: "white" },
            { id: "yy_58", name: "æå“å£åƒ", nameColor: "white", remark: "ç›¸å…³ä»»åŠ¡ï¼šæ±‚åŠ©", remarkColor: "white" },
            { id: "yy_59", name: "èµ¤æ‰‹ç©ºæ‹³æ‰“æ­»ä½ ", nameColor: "white", remark: "ç›¸å…³ä»»åŠ¡ï¼šé‡‡èŠ±è´¼çš„æœ«æ—¥", remarkColor: "white" },
            { id: "yy_60", name: "æ— è€»ç¾¤æ®´æ—", nameColor: "white", remark: "ç›¸å…³ä»»åŠ¡ï¼šå¹¿æ”¶æ•™ä¼—", remarkColor: "white" },
            { id: "yy_61", name: "æ¥è‡ªä¸œåŒ—æ–¹çš„çªç“œ", nameColor: "white", remark: "ç›¸å…³ä»»åŠ¡ï¼šé—¨æ´¾è®¾ç«‹ä¹‹ä¸‰", remarkColor: "white" },
            { id: "yy_62", name: "ä¹å‘½æ€ªçŒ«", nameColor: "white", remark: "ç›¸å…³ä»»åŠ¡ï¼šä¿æŠ¤æ ‘æ—", remarkColor: "white" }
        ]
    }
];

// ... (åç»­è„šæœ¬é€»è¾‘ä¿æŒåŸæ ·) ...

let accounts = [];

document.addEventListener('DOMContentLoaded', () => {
    loadData();
    if (accounts.length === 0) {
        addAccount("ä¸»è´¦å·");
    } else {
        render();
    }
});

function loadData() {
    const data = localStorage.getItem(STORAGE_KEY);
    if (data) {
        try {
            accounts = JSON.parse(data);
        } catch (e) {
            accounts = [];
        }
    }
}

function saveData() {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(accounts));
    render();
}

function addAccount(name = "æ–°è´¦å·") {
    const newAccount = {
        id: Date.now().toString(),
        name: name,
        progress: {} 
    };
    accounts.push(newAccount);
    saveData();
}

function removeAccount(id) {
    if(confirm("ç¡®å®šåˆ é™¤è¯¥è´¦å·åŠå…¶æ‰€æœ‰è¿›åº¦å—ï¼Ÿ")) {
        accounts = accounts.filter(acc => acc.id !== id);
        saveData();
    }
}

function resetAll() {
    if(confirm("ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰è´¦å·å’Œè¿›åº¦æ•°æ®å—ï¼Ÿæ­¤æ“ä½œæ— æ³•æ¢å¤ï¼")) {
        localStorage.removeItem(STORAGE_KEY);
        location.reload();
    }
}

function updateName(id, newName) {
    const acc = accounts.find(a => a.id === id);
    if (acc) {
        acc.name = newName;
        localStorage.setItem(STORAGE_KEY, JSON.stringify(accounts));
    }
}

function toggleTask(accId, taskId) {
    const acc = accounts.find(a => a.id === accId);
    if (!acc) return;
    
    if (typeof acc.progress[taskId] === 'undefined') acc.progress[taskId] = 0;
    
    const currentVal = acc.progress[taskId];
    const newVal = currentVal >= 1 ? 0 : 1;
    acc.progress[taskId] = newVal;
    
    const cellEl = document.getElementById(`cell-${accId}-${taskId}`);
    const checkEl = document.getElementById(`check-${accId}-${taskId}`);
    
    if (checkEl) checkEl.checked = (newVal === 1);
    
    if (cellEl) {
        if (newVal === 1) cellEl.classList.add('task-done-cell');
        else cellEl.classList.remove('task-done-cell');
    }
    
    localStorage.setItem(STORAGE_KEY, JSON.stringify(accounts));
    updateProgressUI();
}

function calculateProgress(acc) {
    let max = 0, current = 0;
    TASK_TEMPLATE.forEach(cat => {
        cat.tasks.forEach(task => {
            max += 1; 
            current += (acc.progress[task.id] && acc.progress[task.id] >= 1) ? 1 : 0;
        });
    });
    const pct = max === 0 ? 0 : Math.round((current / max) * 100);
    return { current, max, pct };
}

function updateProgressUI() {
    let globalTotal = 0, globalMax = 0;
    
    accounts.forEach(acc => {
        const stats = calculateProgress(acc);
        globalTotal += stats.current;
        globalMax += stats.max;
        
        const headPct = document.getElementById(`head-pct-${acc.id}`);
        const headBar = document.getElementById(`head-bar-${acc.id}`);
        if(headPct) headPct.innerText = `${stats.pct}%`;
        if(headBar) headBar.style.width = `${stats.pct}%`;
    });
    
    const gPct = globalMax === 0 ? 0 : Math.round((globalTotal / globalMax) * 100);
    const globalText = document.getElementById('global-progress-text');
    const globalFill = document.getElementById('global-progress-fill');
    
    if(globalText) globalText.innerText = `${gPct}%`;
    if(globalFill) globalFill.style.width = `${gPct}%`;
}

function render() {
    const table = document.getElementById('checklist-table');
    
    let theadHtml = `<thead><tr><th>ç§°å· / ä»»åŠ¡</th>${accounts.map(acc => {
        const stats = calculateProgress(acc);
        return `
            <th>
                <div class="acc-header">
                    <input class="acc-name-input" value="${acc.name}" onchange="updateName('${acc.id}', this.value)" placeholder="è´¦å·å">
                    <div style="width:100%; display:flex; justify-content:space-between; font-size:12px; color:#666;">
                        <span id="head-pct-${acc.id}">${stats.pct}%</span>
                        <span style="cursor:pointer; color:#d9534f;" onclick="removeAccount('${acc.id}')">åˆ é™¤</span>
                    </div>
                    <div class="acc-progress-bar">
                        <div id="head-bar-${acc.id}" class="acc-progress-fill" style="width:${stats.pct}%"></div>
                    </div>
                </div>
            </th>`;
    }).join('')}</tr></thead>`;
    
    let tbodyHtml = '<tbody>';
    
    const getStyle = (color) => {
        if (!color) return '';
        const lightColors = ['white', '#efce9e', '#6cfb4b']; 
        if (lightColors.includes(color.toLowerCase())) {
            return `style="color:${color}; background-color: #444; padding: 1px 4px; border-radius: 3px; display:inline-block;"`;
        }
        return `style="color:${color}"`;
    };

    TASK_TEMPLATE.forEach(cat => {
        tbodyHtml += `<tr class="category-row"><td colspan="${accounts.length + 1}">${cat.category}</td></tr>`;
        
        cat.tasks.forEach(task => {
            const nameStyle = getStyle(task.nameColor);
            const remarkStyle = getStyle(task.remarkColor);
            
            let remarkHtml = '';
            if (task.remark) {
                const prefix = "ç›¸å…³ä»»åŠ¡ï¼š";
                if (task.remark.startsWith(prefix)) {
                    const content = task.remark.substring(prefix.length);
                    remarkHtml = `<div class="task-remark">${prefix}<span ${remarkStyle}>${content}</span></div>`;
                } else {
                    remarkHtml = `<div class="task-remark"><span ${remarkStyle}>${task.remark}</span></div>`;
                }
            }

            tbodyHtml += `<tr>
                <td>
                    <div class="task-name">
                        <span ${nameStyle}>${task.name}</span>
                    </div>
                    ${remarkHtml}
                </td>
                ${accounts.map(acc => {
                    const isDone = (acc.progress[task.id] && acc.progress[task.id] >= 1);
                    return `
                        <td id="cell-${acc.id}-${task.id}" class="${isDone ? 'task-done-cell' : ''}" onclick="if(event.target.tagName !== 'INPUT') toggleTask('${acc.id}', '${task.id}')">
                            <div class="checkbox-wrapper">
                                <input type="checkbox" 
                                       id="check-${acc.id}-${task.id}" 
                                       class="custom-checkbox" 
                                       ${isDone ? 'checked' : ''} 
                                       onchange="toggleTask('${acc.id}', '${task.id}')">
                            </div>
                        </td>`;
                }).join('')}
            </tr>`;
        });
    });
    
    tbodyHtml += '</tbody>';
    table.innerHTML = theadHtml + tbodyHtml;
    updateProgressUI();
}
</script>